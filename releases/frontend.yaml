---
apiVersion: flux.weave.works/v1beta1
kind: HelmRelease
metadata:
  name: frontend
  namespace: test
  annotations:
    flux.weave.works/automated: "true"
    flux.weave.works/tag.chart-image: glob:dev-*
spec:
  releaseName: frontend
  chart:
    repository: https://flagger.app/
    name: podinfo
    version: 2.2.0
  values:
    faults:
      delay: true
    image:
      repository: chapod21/podinfo
      tag: dev-7a2snvhg
    backend: http://backend-podinfo:9898/echo
    canary:
      thresholds:
        latency: 100
      analysis:
        maxWeight: 10
        interval: 5m
        threshold: 2
        stepWeight: 2
      enabled: true
      helmtest:
        enabled: false
        url: http://flagger-helmtester-loadtester.kube-system
      istioIngress:
        enabled: true
        gateway: internal.istio-system.svc.cluster.local
        host: testing.flagger.store.aws.z8s.io
      loadtest:
        enabled: false
